{% extends 'layout/base.html' %}


{% block title %}Tiếp nhận học sinh{% endblock %}

{%block css%}
<style>
    .sidebar {
        background-color: #f7f7fa;
        border-right: 1px solid #ececf5;
        bottom: 0;
        left: 0;
        margin-top: 0;
        position: fixed;
        top: 60px;
        transition: all 0.2s ease-in-out 0s;
        width: 320px;
        z-index: 1001;
    }
    <!--.sidebar.opened {-->
    <!--	-webkit-transition: all 0.4s ease;-->
    <!--	-moz-transition: all 0.4s ease;-->
    <!--	transition: all 0.4s ease;-->
    <!--}-->
    .sidebar-inner {
        height: 100%;
        min-height: 100%;
        transition: all 0.2s ease-in-out 0s;
    }
    .sidebar-menu {
        padding: 15px;
    }
    .sidebar-menu ul {
        font-size: 15px;
        list-style-type: none;
        margin: 0;
        padding: 0;
        position: relative;
    }
    .sidebar-menu li a {
        color: #6f6f6f;
        display: block;
        font-size: 16px;
        height: auto;
        padding: 0 20px;
    }
    .sidebar-menu li a:hover {
        color: #18aefa;
    }
    .sidebar-menu > ul > li > a:hover {
        background-color: #fff;
        color: #18aefa;
        margin: 0px -15px;
        padding-left: 30px;
    }
    .sidebar-menu li.active > a {
        background-color: #fff;
        color: #18aefa;
        position: relative;
        margin: 0px -15px;
        padding-left: 30px;
    }
    .sidebar-menu li.active > a::before {
        width: 5px;
        content: "";
        height: 100%;
        position: absolute;
        left: 0;
        top: 0;
        background: #18aefa;
    <!--    -webkit-transition: all 0.5s;-->
    <!--    -ms-transition: all 0.5s;-->
    <!--    transition: all 0.5s;-->
    }
    .menu-title {
        color: #9e9e9e;
        display: flex;
        font-size: 14px;
        opacity: 1;
        padding: 5px 15px;
        white-space: nowrap;
    }
    .menu-title > i {
        float: right;
        line-height: 40px;
    }
    .sidebar-menu li.menu-title a {
        color: #ff9b44;
        display: inline-block;
        margin-left: auto;
        padding: 0;
    }
    <!--.sidebar-menu li.menu-title a.btn {-->
    <!--    color: #fff;-->
    <!--    display: block;-->
    <!--    float: none;-->
    <!--    font-size: 15px;-->
    <!--    margin-bottom: 15px;-->
    <!--    padding: 10px 15px;-->
    <!--}-->
    .sidebar-menu ul ul a.active {
        color: #18aefa;
    }
    <!--.mobile_btn {-->
    <!--	display: none;-->
    <!--	float: left;-->
    <!--}-->

    .sidebar .sidebar-menu > ul > li > a span {
        transition: all 0.2s ease-in-out 0s;
        display: inline-block;
        margin-left: 10px;
        white-space: nowrap;
    }
    .sidebar .sidebar-menu > ul > li > a span.chat-user {
        margin-left: 0;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    .sidebar .sidebar-menu > ul > li > a span.badge {
        margin-left: auto;
    }
    .sidebar-menu ul ul a {
        display: block;
        font-size: 15px;
        padding: 7px 10px 7px 45px;
        position: relative;
    }
    .sidebar-menu ul ul {
        display: none;
    }
    .sidebar-menu ul ul ul a {
        padding-left: 65px;
    }
    .sidebar-menu ul ul ul ul a {
        padding-left: 85px;
    }
    .sidebar-menu > ul > li {
        margin-bottom: 3px;
        position: relative;
    }
    <!--.sidebar-menu > ul > li:last-child {-->
    <!--    margin-bottom: 0;-->
    <!--}-->
    .sidebar-menu .menu-arrow {
        -webkit-transition: -webkit-transform 0.15s;
        -o-transition: -o-transform 0.15s;
        transition: transform .15s;
        position: absolute;
        right: 15px;
        display: inline-block;
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        text-rendering: auto;
        line-height: 40px;
        font-size: 16px;
    <!--	-webkit-font-smoothing: antialiased;-->
    <!--	-moz-osx-font-smoothing: grayscale;-->
    <!--	-webkit-transform: translate(0, 0);-->
    <!--	-ms-transform: translate(0, 0);-->
    <!--	-o-transform: translate(0, 0);-->
    <!--	transform: translate(0, 0);-->
        line-height: 18px;
        top: 14px;
    }
    .sidebar-menu .menu-arrow:before {
        content: "\f105";
    }
    .sidebar-menu li a.subdrop .menu-arrow {
        -ms-transform: rotate(90deg);
        -webkit-transform: rotate(90deg);
        -o-transform: rotate(90deg);
        transform: rotate(90deg);
    }
    .sidebar-menu ul ul a .menu-arrow {
        top: 10px;
    }
    .sidebar-menu > ul > li > a {
        align-items: center;
        display: flex;
        justify-content: flex-start;
        padding: 12px 15px;
        position: relative;
        transition: all 0.2s ease-in-out 0s;
    }
    .sidebar-menu ul li a i {
        display: inline-block;
        font-size: 16px;
        line-height: 24px;
        text-align: left;
        vertical-align: middle;
        width: 20px;
        transition: all 0.2s ease-in-out 0s;
    }
    .sidebar-menu ul li.menu-title a i {
        font-size: 16px !important;
        margin-right: 0;
        text-align: right;
        width: auto;
    }
    .sidebar-menu li a > .badge {
        color: #fff;
    }

     .main-wrapper {
        width: 100%;
        height: 100vh;
        min-height: 100vh;
    }
    .page-wrapper {
        margin-left: 320px;
        padding-top: 20px;
        position: relative;
        transition: all 0.4s ease;
    }
    .page-wrapper > .content {
        padding: 1.875rem 1.875rem 0;
    }
    .page-header {
        margin-bottom: 1.875rem;
    }
    .page-header .breadcrumb {
        background-color: transparent;
        color: #6c757d;
        font-size: 1rem;
        font-weight: 500;
        margin-bottom: 0;
        padding: 0;
    }
    .page-header .breadcrumb a {
        color: #333;
    }
    .page-title {
        font-size: 28px;
        font-weight: 600;
        color: #333;
        margin-bottom: 5px;
    }
    .form-control {
    border: 1px solid #ddd;
    box-shadow: none;
    color: #333;
    font-size: 15px;
    height: 40px;
}
.form-control:focus {
	border-color: #FFBC53;
	box-shadow: none;
	outline: 0 none;
}
.form-control.form-control-sm {
	height: calc(1.5em + .5rem + 2px);
}
.form-control-sm {
	background-color: #fff;
}

.form-control.form-control-lg {
	height: calc(1.5em + 1rem + 2px);
}
.form-group {
	margin-bottom: 1.25rem;
}
.input-group .form-control {
	height: 40px;
}

    .table {
	color: #333;
	max-width: 100%;
	margin-bottom: 0;
	width: 100%;
}
.table-striped > tbody > tr:nth-of-type(2n+1) {
	background-color: #f8f9fa;
}
.table.no-border > tbody > tr > td,
.table > tbody > tr > th,
.table.no-border > tfoot > tr > td,
.table.no-border > tfoot > tr > th,
.table.no-border > thead > tr > td,
.table.no-border > thead > tr > th {
	border-top: 0;
	padding: 10px 8px;
}
.table-nowrap td,
.table-nowrap th {
	white-space: nowrap
}
.table.dataTable {
	border-collapse: collapse !important;
	border: 1px solid rgba(0, 0, 0, 0.05);
}
table.table td h2 {
	display: inline-block;
	font-size: inherit;
	font-weight: 400;
	margin: 0;
	padding: 0;
	vertical-align: middle;
}
table.table td h2.table-avatar {
    align-items: center;
    display: inline-flex;
    font-size: inherit;
    font-weight: 400;
    margin: 0;
    padding: 0;
    vertical-align: middle;
	white-space: nowrap;
}
table.table td h2 a {
	color: #333;
}
table.table td h2 a:hover {
	color: #FFBC53;
}
table.table td h2 span {
	color: #888;
	display: block;
	font-size: 12px;
	margin-top: 3px;
}
.table thead tr th {
	font-weight: 600;
}
.table tbody tr {
	border-bottom: 1px solid rgba(0, 0, 0, 0.05);
}
.table.table-center td,
.table.table-center th {
	vertical-align: middle;
}
.table-hover tbody tr:hover {
	background-color: #f7f7f7;
}
.table-hover tbody tr:hover td {
	color: #474648;
}
.table-striped thead tr {
	border-color: transparent;
}
.table-striped tbody tr {
	border-color: transparent;
}
.table-striped tbody tr:nth-of-type(even) {
	background-color: rgba(255, 255, 255, 0.3);
}
.table-striped tbody tr:nth-of-type(odd) {
	background-color: rgba(235, 235, 235, 0.4);
}
.table-bordered {
	border: 1px solid rgba(0, 0, 0, 0.05) !important;
}
.table-bordered th,
.table-bordered td {
	border-color: rgba(0, 0, 0, 0.05);
}
.card-table .card-body .table > thead > tr > th {
    border-top: 0;
}
.card-table .card-body .table tr td:first-child,
.card-table .card-body .table tr th:first-child {
    padding-left: 1.5rem;
}
.card-table .card-body .table tr td:last-child,
.card-table .card-body .table tr th:last-child {
    padding-right: 1.5rem;
}
.card-table .table td, .card-table .table th {
    border-top: 1px solid #e2e5e8;
    padding: 1rem 0.75rem;
    white-space: nowrap;
}
.table .thead-light th {
    color: #495057;
    background-color: #f8f9fa;
    border-color: #eff2f7;
}

</style>
{%endblock%}

{%block js%}
<script>
$(document).ready(function () {
        // Handle select box change event
        $('#classSelector').change(function () {
            // Get the selected class ID
            var selectedClassId = $(this).val();

            // Make an AJAX request to get data for the selected class
            $.ajax({
                url: '/get_data',  // Replace with your Flask route
                type: 'POST',
                data: { 'class_id': selectedClassId },
                success: function (data) {
                    // Update the table with the received data
                    updateTable(data);
                },
                error: function (error) {
                    console.log(error);
                }
            });
        });

        // Function to update the table with data
        function updateTable(data) {
            // Clear existing rows
            $('#dataTable tbody').empty();

            // Append new rows
            data.forEach(function (row) {
                var formatteddateOfBirth = formatdateOfBirth==(row.dateOfBirth);
                var newRow = '<tr>' +
                    '<td>' + row.id + '</td>' +
                    '<td>' + row.name + '</td>' +
                    '<td>' + row.gender + '</td>' +
                    '<td>' + formatteddateOfBirth  + '</td>' +
                    '<td>' + row.address + '</td>' +
                    '<td><button class="btn-sua-hs btn btn-warning" data-id="' + row.id + '"><i class="fas fa-pen"></i></button></td>' +
                    '</tr>';
                $('#dataTable tbody').append(newRow);
            });
        }
        // Function to format dateOfBirth
        function formatdateOfBirth(dateOfBirth) {
            var date = new Date(dateOfBirth);
            var day = date.getDate();
            var month = date.getMonth() + 1;
            var year = date.getFullYear();
            return (day < 10 ? '0' : '') + day + '/' + (month < 10 ? '0' : '') + month + '/' + year;
        }
    });
</script>
{%endblock%}

{%block body%}
<div class="sidebar" id="sidebar">
    <div class="sidebar-inner slimscroll">
        <div id="sidebar-menu" class="sidebar-menu">
            <ul>
                <li class="menu-title">
                    <span>Quản lý</span>
                </li>
                <li class="submenu">
                    <a href="/tiepnhan"><i class="fas fa-user-graduate"></i> <span>Tiếp nhận học sinh</span> <span
                            class="menu-arrow"></span></a>
                </li>
                <li class="submenu">
                    <a href="/dshocsinh"><i class="fas fa-chalkboard-teacher"></i> <span>Danh sách học sinh</span> <span
                            class="menu-arrow"></span></a>
                </li>
                <li class="submenu">
                    <a href="/themlop"><i class="fas fa-building"></i> <span>Thêm lớp học </span> <span
                            class="menu-arrow"></span></a>
                </li>
                <li class="submenu">
                    <a href="/dslop"><i class="fas fa-book"></i> <span>Danh sách lớp</span> <span
                            class="menu-arrow"></span></a>
                </li>
            </ul>
        </div>
    </div>
</div>


<div class="page-wrapper">
    <div class="content container-fluid">
        <div class="page-header">
            <div class="row align-items-center">
                <div class="col">
                    <h3 class="page-title">Danh sách lớp</h3>
                    <ul class="breadcrumb">
                        <li class="breadcrumb-item"><a href="#">Lớp</a></li>
                        <li class="breadcrumb-item active">Xem danh sách lớp</li>
                    </ul>
                </div>
                <div class="col-auto text-right float-right ml-auto">
                    <a href="#" class="btn btn-outline-primary mr-2"><i class="fas fa-download"></i>Tải xuống</a>
                </div>
            </div>
        </div>
    </div>
    <div class="content container-fluid">
        <div class="col-12 col-sm-3">
            <div class="form-group">
                <label>Chọn lớp</label>
                <select class="form-control" name="" id="classSelector">
                    <option disabled selected>Chọn lớp</option>
                    {% for l in class_list %}
                    <option value="{{ l.id }}">{{ l.name }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-12">
            <div class="card card-table">
                <div class="card-body">
                    <div class="table-responsive">
                        <table id="dataTable" class="table table-hover table-center mb-0 datatable">
                            <thead>
                            <tr>
                                <th>ID</th>
                                <th>Họ tên</th>
                                <th>Giới tính</th>
                                <th>Ngày sinh</th>
                                <th>Địa chỉ</th>
                                <th>Chỉnh sửa</th>
                            </tr>
                            </thead>
                            <tbody id="hs_table_body">
<!--                            {% for class_id, student in data %}-->
<!--                            <tr>-->
<!--                                <td>{{ student.id }}</td>-->
<!--                                <td>-->
<!--                                    <h2 class="table-avatar">-->
<!--                                        <a href="#">{{ student.name }}</a>-->
<!--                                    </h2>-->
<!--                                </td>-->
<!--                                <td>{{ student.gender }}</td>-->
<!--                                <td>{{student.dateOfBirth }}</td>-->
<!--                                <td>{{ student.address }}</td>-->
<!--                            </tr>-->
<!--                            {% endfor %}-->

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>


<div class="page-wrapper">
    <div class="content container-fluid">
        <div class="row">
            <div class="col-sm-12">
                <div class="card card-table">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table id="class_list" class="table table-hover table-center mb-0 datatable">
                                <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Tên lớp</th>
                                    <th>Sĩ số</th>
                                    <th>Mã khối lớp</th>
                                    <th>Chỉnh sửa</th>
                                </tr>
                                </thead>
                                <tbody class="lop-table-body">
                                {% for l in class_list %}
                                <tr>
                                    <td>{{ l.id }}</td>
                                    <td>
                                        <h2 class="table-avatar">
                                            <a href="#">{{ l.name }}</a>
                                        </h2>
                                    </td>
                                    <td>{{ l.siSo }}</td>
                                    <td>{{ l.grade }}</td>
                                    <td>
                                        <div class="actions">
                                            <button class="btn-sua btn btn-outline-primary" data-id="{{ l.id }}">
                                                <i class="fas fa-pen"></i>
                                            </button>
                                            <button class="btn-xoa btn btn-outline-primary" data-id="{{ l.id }}">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal để sửa thông tin sinh viên -->
<div class="modal fade" id="modalchinhhs" tabindex="-1" role="dialog" aria-labelledby="editModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">

            <div class="modal-header">
                <h5 class="modal-title" id="editModalLabel">Sửa Thông Tin Sinh Viên</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- Form để nhập thông tin mới của học sinh -->
                <form id="formchinhhs">
                    <div class="form-group">
                        <label for="name">Họ và tên:</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="dateOfBirth">Ngày sinh:</label>
                        <input type="date" id="dateOfBirth" name="dateOfBirth" required>
                    </div>
                    <div class="form-group">
                        <label for="gender">Giới tính:</label>
                        <input type="text" id="gender" name="gender" required>
                    </div>
                    <div class="form-group">
                        <label for="address">Địa chỉ:</label>
                        <input type="text" id="address" name="address" required>
                    </div>
                    <div class="form-group">
                        <label for="phoneNumber">Số điện thoại:</label>
                        <input type="text" id="phoneNumber" name="phoneNumber" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email:</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="joined_date">Ngày nhập học:</label>
                        <input type="date" id="joined_date" name="joined_date" required>
                    </div>
                    <div class="form-group">
                        <label for="class_id">Lớp:</label>
                        <input type="text" id="class_id" name="class_id" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Lưu Thay Đổi</button>
                </form>
            </div>
        </div>
    </div>
</div>


<!-- Modal chỉnh sửa thông tin lớp học -->
<div class="modal" id="editModal">
    <div class="modal-dialog">
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title">Chỉnh Sửa Thông Tin Lớp Học</h4>
                <button type="button" class="close" data-dismiss="modal" id="closeModalBtn">&times;</button>
            </div>

            <!-- Modal Body -->
            <div class="modal-body">
                <form id="editForm">
                    <div class="form-group">
                        <label for="tenLop">Tên Lớp:</label>
                        <input type="text" class="form-control" id="tenLop" required>
                    </div>
                    <div class="form-group">
                        <label for="siSo">Sĩ Số:</label>
                        <input type="number" class="form-control" id="siSo" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Lưu</button>
                </form>
            </div>
        </div>
    </div>
</div>

{%endblock%}

{%block footer%}

{%endblock%}