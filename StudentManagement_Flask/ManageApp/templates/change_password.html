{% extends 'layout/base.html' %}

{% block title %} Đổi mật khẩu {% endblock %}

{% block body %}
<div class="form-change-pw" style="margin:50px auto; width:100%; max-width:500px; height:auto;">
    <h1 class="text-center heading" style="margin-top:30px; margin-bottom:30px; font-family: 'Arial', sans-serif; color:#333; font-weight: bold;">Đổi mật khẩu</h1>

    {% if error_msg %}
    <div class="alert alert-danger" role="alert" style="font-size:14px; margin-bottom:20px;">
        {{ error_msg }}
    </div>
    {% endif %}

    {% if success_msg %}
    <div class="alert alert-success" role="alert" style="font-size:14px; margin-bottom:20px;">
        {{ success_msg }}
    </div>
    <p id="countdown" style="font-size:14px; color:#333; text-align:center;">Đang chuyển hướng trong <span id="timer">3</span> giây...</p>
    <script>
        var countdown = 3; // 3 seconds countdown
        var timerElement = document.getElementById("timer");

        function updateCountdown() {
            if (countdown <= 0) {
                window.location.href = "{{ url_for('user_login') }}"; // Redirect to login page
            } else {
                timerElement.textContent = countdown; // Update timer on the page
                countdown--;
                setTimeout(updateCountdown, 1000); // Decrease countdown every second
            }
        }

        updateCountdown(); // Start the countdown
    </script>
    {% endif %}

    <form method="post" style="background-color:#f9f9f9; padding:40px; border-radius:10px; box-shadow: 0px 4px 15px rgba(0, 0, 0, 0.1);">
        <div class="form-group" style="margin-bottom:20px;">
            <label for="o-password" style="font-weight:bold; color:#333; font-size:14px;">Mật khẩu cũ:</label>
            <input type="password"
                   name="o-password"
                   class="form-control"
                   id="o-password"
                   placeholder="Nhập mật khẩu cũ..."
                   required style="font-size:14px; padding:10px; border-radius:8px;"/>
            <small id="o-passwordHelp" class="text-danger" style="opacity:0; font-size:12px; margin-top:5px;">
                Mật khẩu cũ không đúng
            </small>
        </div>
        <div class="form-group" style="margin-bottom:20px;">
            <label for="n-password" style="font-weight:bold; color:#333; font-size:14px;">Mật khẩu mới:</label>
            <input type="password"
                   name="n-password"
                   class="form-control"
                   id="n-password"
                   placeholder="Nhập mật khẩu mới..."
                   required minlength="3" style="font-size:14px; padding:10px; border-radius:8px;"/>
            <small id="n-passwordHelp" class="text-danger" style="opacity:0; font-size:12px; margin-top:5px;">
                Mật khẩu phải chứa từ 3 ký tự trở lên
            </small>
        </div>
        <div class="form-group" style="margin-bottom:30px;">
            <label for="c-password" style="font-weight:bold; color:#333; font-size:14px;">Xác nhận mật khẩu:</label>
            <input type="password"
                   name="c-password"
                   class="form-control"
                   id="c-password"
                   placeholder="Nhập lại mật khẩu mới..."
                   required style="font-size:14px; padding:10px; border-radius:8px;"/>
            <small id="c-passwordHelp" class="text-danger" style="opacity:0; font-size:12px; margin-top:5px;">
                Mật khẩu không giống nhau
            </small>
        </div>

        <input type="submit" value="Thay đổi" class="btn btn-danger" style="width:100%; padding:12px; font-size:16px; font-weight:bold; border-radius:8px;"/>
    </form>
</div>

<style>
    .form-change-pw {
        background-color: #fff;
        border-radius: 10px;
        padding: 40px;
        box-shadow: 0px 2px 20px rgb(0 0 0 / 8%);
    }
    .form-control {
        border: 1px solid #ddd;
        transition: border-color 0.3s;
    }
    .form-control:focus {
        border-color: #007bff;
    }
    .btn-danger {
        background-color: #d9534f;
        border: none;
        color: white;
    }
    .btn-danger:hover {
        background-color: #c9302c;
    }
    .alert {
        font-size: 14px;
        margin-bottom: 20px;
        padding: 15px;
        border-radius: 8px;
    }
    .alert-success {
        background-color: #d4edda;
        color: #155724;
    }
    .alert-danger {
        background-color: #f8d7da;
        color: #721c24;
    }
</style>

{% endblock %}
